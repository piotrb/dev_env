#!env ruby
has_bundle = File.exist?("Gemfile")
is_compatible_app = File.exist?('config/application.rb') || File.exist?('config/spring.rb')
has_spring_in_bundle = `bundle list`.split("\n").grep(/spring/).any?
if is_compatible_app && ((has_bundle && has_spring_in_bundle) || !has_bundle)
  exec 'bundle', 'exec', 'spring', *ARGV
else
  if File.exist?('Gemfile')
    exec 'bundle', 'exec', *ARGV
  else
    exec *ARGV
  end
end
